# Installing and configuring HCL Connections Add-in for Microsoft Outlook Standalone Install {#t_outlook_addin_standalone_install .task}

Installing and setting up the HCL Connections Add-in for Microsoft Outlook as a standalone docker image.

The following are required to install the Connections Add-in for Outlook.

-   Downloading the Connections Add-in for Outlook from [My HCLSoftware](https://my.hcltechsw.com/).
-   Registering the Connections Add-in for Outlook OAuth application provider with Connections
-   Registering the Connections Add-in in Microsoft Entra.
-   Updating the Connections Add-in for Outlook docker environment variables.
-   Loading the Connections Add-in for Outlook docker image.
-   Deploying the Connections Add-in for Outlook docker instance.
-   Adding the Connections Add-in for Outlook add-in proxy rules to proxy server configuration.
-   Making the Connections Add-in for Outlook available to users.

**Downloading the Connections Add-in for Outlook** [Download the HCL Connections Add-in for Microsoft Outlook standalone install from My HCLSoftware](https://support.hcltechsw.com/csm?id=kb_article&sysparm_article=KB0085519&sys_kb_id=ecb956cedbb86014a45ad9fcd39619a8).

**Registering the Connections Add-in for Outlook OAuth application provider** - In a Standalone deploy, you must manually register the OAuth provider. Refer to [Registering the Connections Add-in for Outlook OAuth application provider](https://help.hcltechsw.com/connections/v8/admin/install/cp_3p_outlook_addin_oauth.html) for additional information.

**Registering the Connections Add-in in Microsoft Entra** - To use the Connections Add-in for Outlook, you must perform an app registration in your Microsoft Entra ID (formerly Azure Active Directory) tenant. This registration is a unique identity for the Connections Add-in and allows it to securely interact with Microsoft services, such as Microsoft Graph, on behalf of your users. During this registration, you will obtain the Client ID (Application ID) and configure the necessary API permissions to ensure the add-in can function correctly within Outlook. Refer to [Registering the Connections Add-in for Outlook OAuth application provider](https://help.hcltechsw.com/connections/v8/admin/install/cp_3p_outlook_addin_oauth.html) for additional information.

**Updating the Connections Add-in for Outlook docker environment variables**

The Connections Add-in for Outlook relies on environment variables for configuration. These will need to be modified to fit your environment before running the Connections Add-in for Outlook docker image. The environment variables and their default values are located in the **override.yaml** file. Depending on your deployment, you can either modify the **override.yaml** file and pass that on the deployment step, or you can pass the updated individual variables on the command line.

-   What must be overridden:
    -   CONNECTIONS\_URL – URL of your Connections environment without a trailing slash. For example, https://my.connections.server.com. The same URL has to be used when generating secret in the first step.
    -   CONNECTIONS\_CLIENT\_SECRET - Client secret generated by Connections when registering OAuth provider in the first step.
    -   CONNECTIONS\_CLIENT\_ID - Client ID \(aka. app ID\) used when registering OAuth provider in Connections in the first step \(default: connections-outlook-desktop\)
    -   ENTRA\_CLIENT\_ID - The unique identifier for the Outlook add-in's application registration within Microsoft Entra.
    -   ENTRA\_TENANT\_ID - The unique identifier for your organization's Microsoft Entra tenant (directory).
-   What may be overridden:
    -   CONTEXT\_ROOT - The path to where the Connections Add-in for Outlook is being served, relative to the CONNECTIONS\_URL. Do NOT start or end with \`/. \(default: outlook-addin\)
    -   SUPPORT\_URL - URL that an end user can go to for information. Defaults to [Using the HCL Connections Add-in for Microsoft Outlook](https://help.hcltechsw.com/connections/v8/connectors/enduser/c_ms_plugins_add_in_outlook.html)
    -   CONNECTIONS\_NAME – A custom name for the add-in..\(default: 'HCL Connections'\)

**Note:**

-   Take care about ingresses listed there. You should point to both frontend domain and internal domains, if both are used. Otherwise, only point to the one that is used in your case.
-   The shift to Microsoft Graph from Exchange Web Services (EWS) eliminates the need for the `EWS_HOSTNAME`.

**Loading the Connections Add-in for Outlook docker image**

Load the docker image from the compressed file or from your docker registry.

-   To load the Connections Add-in for Outlook docker image from your internal docker registry: docker pull <YOUR\_DOCKER\_REGISTRY\_PATH\>.
-   To load the compressed Connections Add-in for Outlook docker image downloaded from HCL Delivery Portal: docker load -input <COMPRESSED\_FILE\_NAME\>. For example, docker load -input ConnectionsOutlookAddin-21.01.tar.gz
-   Tag image to push
    -   docker tag  <DOCKER\_IMAGE\_ID\> <SERVER\_ADDRESS\>:5000/ <DOCKER\_IMAGE\_TAG\>
    -   For example, docker tag 1234567890 \[http://lcauto21.cnx.cwp.pnp-hcl.com:5000/20211019-235421" title="http://lcauto21.cnx.cwp.pnp-hcl.com:5000/20211019-235421" target="\_blank" rel="noreferrer noopener" tabindex="-1" style="font-family: "Segoe UI", system-ui, "Apple Color Emoji", "Segoe UI Emoji", sans-serif; font-size: 14px; orphans: 2; widows: 2; http://mydockerreg.mycompany.com:5000/\]connections-outlook-desktop
-   Push image
    -   docker push  <SERVER\_ADDRESS\>:5000/<DOCKER\_IMAGE\_TAG\>
    -   For example, docker push \[http://lcauto21.cnx.cwp.pnp-hcl.com:5000/20211019-235421" title="http://lcauto21.cnx.cwp.pnp-hcl.com:5000/20211019-235421" target="\_blank" rel="noreferrer noopener" tabindex="-1" style="font-family: "Segoe UI", system-ui, "Apple Color Emoji", "Segoe UI Emoji", sans-serif; font-size: 14px; orphans: 2; widows: 2; http://mydockerreg.mycompany.com:5000/\]connections-outlook-desktop

**Deploying the Connections Add-in for Outlook docker instance**

The steps to deploy the docker image are slightly different if you are using standalone docker, Kubernetes or using Helm charts. The steps for deploying using the docker service are provided below. The steps for using Kubernetes or using Helm charts are similar but use the equivalent Kubernetes or Helm commands. You should use the provided override.yaml file to update the environment variables.

-   Get docker images 

    docker images

-   Run docker image on your server. Pass in the overridden environment variables. See the environment variables section above for details on the variable values:

    ```
    docker run -itd -p <PORT>:<PORT> 
    --env CONNECTIONS_URL=<SERVER_ADDRESS> 
    --env CONTEXT_ROOT=<CONTEXT_ROOT> 
    --env SUPPORT_URL=<SUPPORT_URL> 
    --env CONNECTIONS_CLIENT_ID=<CONNECTIONS_CLIENT_ID>
    --env CONNECTIONS_CLIENT_SECRET=<CONNECTIONS_CLIENT_SECRET> 
    --env CONNECTIONS_NAME=<CONNECTIONS_NAME>
    --env ENTRA_TENANT_ID=<ENTRA_TENANT_ID>
    --env ENTRA_CLIENT_ID=<ENTRA_CLIENT_ID>
    <IMAGE_ID> 
    ```

    example:

    ```
    docker run -itd -p 8080:8080 
    --env CONNECTIONS_URL=https://connections.mycompany.com 
    --env CONTEXT_ROOT=outlook-addin 
    --env CONNECTIONS_CLIENT_ID=connections-outlook-desktop 
    --env CONNECTIONS_CLIENT_SECRET=8as5FhqBUKyiCLlHoBhGnFFkjeMBQ7HZqXDNMegHxLLchsofahBJK8ZBWlJo
    --env ENTRA_TENANT_ID=6265758f-c887-4021-90fc-9ad22eeeea0b
    --env ENTRA_CLIENT_ID=61f5bccc-94d0-477f-b8da-d89a0e85ffc5
    connections.mycompany.com:5000/connections-outlook-desktop
    ```


**Adding the Connections Add-in for Outlook proxy rules to httpd.conf for your IHS**

You will need to update your proxy with rules to allow for the Connections Add-in for Outlook to function correctly. The example settings below are the ones used for IHS \(taken from the component pack setup\). If you are using another proxy, make comparable changes to the proxy configuration.

Update the rules below to your httpd.conf for your IHS servers and restart IHS. Substitute the appropriate values for the variables shown like <VARIABLE\>:

```
#proxy rules for outlook add-in
Redirect "/<CONTEXT_ROOT>" "/<CONTEXT_ROOT>/" 
ProxyPass "/<CONTEXT_ROOT>/" "https://<SERVER_NAME>:<PORT_ON_WHICH_SERVICE_IS_RUNNING>/“ 
ProxyPassReverse "/<CONTEXT_ROOT>/” "https://<SERVER_NAME>:<PORT_ON_WHICH_SERVICE_IS_RUNNING>/"  

```

example:

```
#proxy rules for outlook-addin	
Redirect "/outlook-addin" "/outlook-addin/" 
ProxyPass "/outlook-addin/" "https://my.connections.server.com:32080/“ 
ProxyPassReverse "/outlook-addin/” "https://my.connections.server.com:32080/"
```

**What's Next:**

The Connections Add-in for Outlook must be added to the users’ Outlook environments. This can be done by the Exchange administrator, or by the users directly

-   Tag image to push
    -   docker tag  <DOCKER\_IMAGE\_ID\> <SERVER\_ADDRESS\>:5000/<DOCKER\_IMAGE\_TAG\>
    -   For example, docker tag 1234567890 [http://mydockerreg.mycompany.com:5000/connections-outlook-desktop](http://mydockerreg.mycompany.com:5000/connections-outlook-desktop)

-   Push image
    -   docker push  <SERVER\_ADDRESS\>:5000/<DOCKER\_IMAGE\_TAG\>
    -   For example, docker push [http://mydockerreg.mycompany.com:5000/connections-outlook-desktop](http://mydockerreg.mycompany.com:5000/connections-outlook-desktop)

**Parent topic:**[Installing via Component pack or Standard Install](../../connectors/admin/c_outlook_addin_installing.md)

